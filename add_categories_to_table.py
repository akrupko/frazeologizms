#!/usr/bin/env python3
"""
Script to add category information directly to the existing table_phrases.json file.
This modifies the original file by adding a 'category' field to each phrase object.
"""

import json
import os
from collections import defaultdict

def add_categories_to_table_phrases():
    """Add category information to each phrase in table_phrases.json."""
    
    # Load the original table_phrases.json
    if not os.path.exists('table_phrases.json'):
        print("Error: table_phrases.json not found!")
        return False
    
    with open('table_phrases.json', 'r', encoding='utf-8') as f:
        phrases = json.load(f)
    
    print(f"Loaded {len(phrases)} phrases from table_phrases.json")
    
    # Define thematic categories with keywords for classification
    categories = {
        'animals': {
            'name': '–ñ–∏–≤–æ—Ç–Ω—ã–µ –∏ –ø—Ä–∏—Ä–æ–¥–∞',
            'description': '–§—Ä–∞–∑–µ–æ–ª–æ–≥–∏–∑–º—ã —Å –∂–∏–≤–æ—Ç–Ω—ã–º–∏, –ø—Ç–∏—Ü–∞–º–∏ –∏ –ø—Ä–∏—Ä–æ–¥–Ω—ã–º–∏ —è–≤–ª–µ–Ω–∏—è–º–∏',
            'keywords': ['–∫–æ—Ç', '—Å–æ–±–∞–∫', '–≤–æ–ª–∫', '–ª–∏—Å–∞', '–º–µ–¥–≤–µ–¥', '–∑–∞—è—Ü', '–º—ã—à', '–ø—Ç–∏—Ü', '–∫–æ–Ω—å', '–ª–æ—à–∞–¥', '–∫–æ—Ä–æ–≤–∞', '–æ–≤—Ü', '–∫–æ–∑–µ–ª', '–±–∞—Ä–∞–Ω', '—Ä—ã–±', '–∑–º–µ—è', '–ª–µ–≤', '—Ç–∏–≥—Ä', '—Å–ª–æ–Ω', '–æ—Ä–µ–ª', '–≤–æ—Ä–æ–Ω', '—Å–æ—Ä–æ–∫', '–≤–æ—Ä–æ–±–µ–π', '–≥—É—Å', '—É—Ç–∫', '–ø–µ—Ç—É—Ö', '–∫—É—Ä–∏—Ü–∞']
        },
        'body_parts': {
            'name': '–ß–∞—Å—Ç–∏ —Ç–µ–ª–∞',
            'description': '–§—Ä–∞–∑–µ–æ–ª–æ–≥–∏–∑–º—ã —Å —á–∞—Å—Ç—è–º–∏ —Ç–µ–ª–∞ —á–µ–ª–æ–≤–µ–∫–∞',
            'keywords': ['–≥–æ–ª–æ–≤–∞', '–≥–ª–∞–∑', '—É—Ö–æ', '–Ω–æ—Å', '—Ä–æ—Ç', '—è–∑—ã–∫', '–∑—É–±', '—Ä—É–∫–∞', '–Ω–æ–≥–∞', '–ø–∞–ª—å—Ü', '–ø–ª–µ—á–æ', '—Å–ø–∏–Ω–∞', '–≥—Ä—É–¥—å', '—Å–µ—Ä–¥—Ü–µ', '–¥—É—à–∞', '–∂–∏–≤–æ—Ç', '—à–µ—è', '–ª–∏—Ü–æ', '–ª–æ–±', '–±–æ—Ä–æ–¥–∞', '–≤–æ–ª–æ—Å', '–∫–æ–∂–∞']
        },
        'religion_mythology': {
            'name': '–†–µ–ª–∏–≥–∏—è –∏ –º–∏—Ñ–æ–ª–æ–≥–∏—è',
            'description': '–§—Ä–∞–∑–µ–æ–ª–æ–≥–∏–∑–º—ã —Å —Ä–µ–ª–∏–≥–∏–æ–∑–Ω—ã–º–∏ –∏ –º–∏—Ñ–æ–ª–æ–≥–∏—á–µ—Å–∫–∏–º–∏ –º–æ—Ç–∏–≤–∞–º–∏',
            'keywords': ['–±–æ–≥', '—á–µ—Ä—Ç', '–¥—å—è–≤–æ–ª', '–∞–¥', '—Ä–∞–π', '–∞–Ω–≥–µ–ª', '–¥—É—à–∞', '–≥—Ä–µ—Ö', '–º–æ–ª–∏—Ç–≤', '—Ü–µ—Ä–∫–æ–≤', '—Å–≤—è—Ç–æ–π', '–±–æ–∂–∏–π', '–≥–æ—Å–ø–æ–¥—å', '—Ö—Ä–∏—Å—Ç–æ—Å', '–±–∏–±–ª–∏—è', '–∞–Ω—Ç–∏—á–Ω', '–≥—Ä–µ—á–µ—Å–∫', '–º–∏—Ñ–æ–ª–æ–≥', '–ª–µ–≥–µ–Ω–¥–∞', '–∞–≤–≥–∏–µ–≤', '–∞—Ö–∏–ª–ª–µ—Å']
        },
        'work_labor': {
            'name': '–¢—Ä—É–¥ –∏ —Ä–∞–±–æ—Ç–∞',
            'description': '–§—Ä–∞–∑–µ–æ–ª–æ–≥–∏–∑–º—ã –æ —Ä–∞–±–æ—Ç–µ, —Ç—Ä—É–¥–µ –∏ –ø—Ä–æ—Ñ–µ—Å—Å–∏–æ–Ω–∞–ª—å–Ω–æ–π –¥–µ—è—Ç–µ–ª—å–Ω–æ—Å—Ç–∏',
            'keywords': ['—Ä–∞–±–æ—Ç', '—Ç—Ä—É–¥', '–¥–µ–ª–æ', '—Å–ª—É–∂–±', '—Ä–µ–º–µ—Å–ª', '–º–∞—Å—Ç–µ—Ä', '–∞—Ä—Ç–µ–ª—å', '–ø–∞—Ö–∞—Ç—å', '—Å–µ—è—Ç—å', '–∂–∞—Ç—å', '–∫–æ—Å–∏', '–º–æ–ª–æ—Ç', '–∫—É–∑–Ω–µ—Ü', '—Å—Ç–æ–ª—è—Ä', '–ø–ª–æ—Ç–Ω–∏–∫', '—à–≤–µ—è', '–ø–æ—Ä—Ç–Ω–æ–π']
        },
        'money_wealth': {
            'name': '–î–µ–Ω—å–≥–∏ –∏ –±–æ–≥–∞—Ç—Å—Ç–≤–æ',
            'description': '–§—Ä–∞–∑–µ–æ–ª–æ–≥–∏–∑–º—ã –æ –¥–µ–Ω—å–≥–∞—Ö, –±–æ–≥–∞—Ç—Å—Ç–≤–µ –∏ –±–µ–¥–Ω–æ—Å—Ç–∏',
            'keywords': ['–¥–µ–Ω—å–≥–∏', '–±–æ–≥–∞—Ç', '–±–µ–¥–µ–Ω', '–∑–æ–ª–æ—Ç–æ', '—Å–µ—Ä–µ–±—Ä–æ', '–∫–æ–ø–µ–π–∫', '—Ä—É–±–ª—å', '–±–µ–¥–Ω–æ—Å—Ç', '–Ω–∏—â–µ—Ç', '–±–æ–≥–∞—Ç—Å—Ç–≤', '–∫–ª–∞–¥', '—Å–æ–∫—Ä–æ–≤–∏—â', '–º–æ–Ω–µ—Ç', '–±—é–¥–∂–µ—Ç', '–¥–æ–ª–≥', '–∑–∞–µ–º', '–∫—Ä–µ–¥–∏—Ç']
        },
        'family_relationships': {
            'name': '–°–µ–º—å—è –∏ –æ—Ç–Ω–æ—à–µ–Ω–∏—è',
            'description': '–§—Ä–∞–∑–µ–æ–ª–æ–≥–∏–∑–º—ã –æ —Å–µ–º–µ–π–Ω—ã—Ö –æ—Ç–Ω–æ—à–µ–Ω–∏—è—Ö –∏ —Ä–æ–¥—Å—Ç–≤–µ–Ω–Ω—ã—Ö —Å–≤—è–∑—è—Ö',
            'keywords': ['–º–∞—Ç—å', '–æ—Ç–µ—Ü', '—Å—ã–Ω', '–¥–æ—á—å', '–±—Ä–∞—Ç', '—Å–µ—Å—Ç—Ä–∞', '–¥–µ–¥', '–±–∞–±—É—à–∫', '–≤–Ω—É–∫', '–º—É–∂', '–∂–µ–Ω–∞', '—Å–µ–º—å—è', '—Ä–æ–¥', '–¥–µ—Ç–µ–π', '—Ä–µ–±–µ–Ω–æ–∫', '—Å—É–ø—Ä—É–≥', '—Å–≤–∞–¥—å–±', '–∂–µ–Ω–∏—Ç—å', '–∑–∞–º—É–∂']
        },
        'time_age': {
            'name': '–í—Ä–µ–º—è –∏ –≤–æ–∑—Ä–∞—Å—Ç',
            'description': '–§—Ä–∞–∑–µ–æ–ª–æ–≥–∏–∑–º—ã –æ –≤—Ä–µ–º–µ–Ω–∏, –≤–æ–∑—Ä–∞—Å—Ç–µ –∏ –∂–∏–∑–Ω–µ–Ω–Ω—ã—Ö –ø–µ—Ä–∏–æ–¥–∞—Ö',
            'keywords': ['–≤—Ä–µ–º—è', '–≥–æ–¥', '–¥–µ–Ω—å', '–Ω–æ—á—å', '—É—Ç—Ä–æ', '–≤–µ—á–µ—Ä', '—á–∞—Å', '–º–∏–Ω—É—Ç', '—Å–µ–∫—É–Ω–¥', '–≤–æ–∑—Ä–∞—Å—Ç', '–º–æ–ª–æ–¥', '—Å—Ç–∞—Ä', '–¥–µ—Ç—Å—Ç–≤', '—é–Ω–æ—Å—Ç—å', '–∑—Ä–µ–ª–æ—Å—Ç', '—Å—Ç–∞—Ä–æ—Å—Ç', '–≤–µ–∫', '—ç–ø–æ—Ö', '—Å–µ–∑–æ–Ω', '–º–µ—Å—è—Ü', '–Ω–µ–¥–µ–ª—è']
        },
        'emotions_feelings': {
            'name': '–≠–º–æ—Ü–∏–∏ –∏ —á—É–≤—Å—Ç–≤–∞',
            'description': '–§—Ä–∞–∑–µ–æ–ª–æ–≥–∏–∑–º—ã –æ —ç–º–æ—Ü–∏–æ–Ω–∞–ª—å–Ω—ã—Ö —Å–æ—Å—Ç–æ—è–Ω–∏—è—Ö –∏ –ø–µ—Ä–µ–∂–∏–≤–∞–Ω–∏—è—Ö',
            'keywords': ['–ª—é–±–æ–≤—å', '–Ω–µ–Ω–∞–≤–∏—Å—Ç', '—Ä–∞–¥–æ—Å—Ç', '–≥—Ä—É—Å—Ç—å', '–ø–µ—á–∞–ª—å', '—Å—Ç—Ä–∞—Ö', '—É–∂–∞—Å', '–≥–Ω–µ–≤', '–∑–ª–æ—Å—Ç', '—è—Ä–æ—Å—Ç', '—Å—á–∞—Å—Ç—å–µ', '–≥–æ—Ä–µ', '—Ç–æ—Å–∫–∞', '—Å–∫—É–∫–∞', '–≤–µ—Å–µ–ª', '—Å–º–µ—Ö', '—Å–ª–µ–∑—ã', '–ø–ª–∞—á', '–æ–±–∏–¥–∞', '–∑–∞–≤–∏—Å—Ç—å', '—Ä–µ–≤–Ω–æ—Å—Ç']
        },
        'mind_intelligence': {
            'name': '–£–º –∏ –≥–ª—É–ø–æ—Å—Ç—å',
            'description': '–§—Ä–∞–∑–µ–æ–ª–æ–≥–∏–∑–º—ã –æ–± –∏–Ω—Ç–µ–ª–ª–µ–∫—Ç—É–∞–ª—å–Ω—ã—Ö —Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç—è—Ö',
            'keywords': ['—É–º', '–≥–ª—É–ø–æ—Å—Ç', '–¥—É—Ä–∞–∫', '–¥—É—Ä–∞', '–º—É–¥—Ä', '–º–æ–∑–≥', '—Ä–∞–∑—É–º', '—Ä–∞—Å—Å—É–¥–æ–∫', '–ø–∞–º—è—Ç—å', '–∑–∞–±—ã–≤', '–ø–æ–º–Ω–∏—Ç—å', '–¥—É–º–∞—Ç—å', '—Å–æ–æ–±—Ä–∞–∂', '–ø–æ–Ω–∏–º–∞', '–∑–Ω–∞—Ç—å', '—É—á–∏—Ç—å', '–æ–±—Ä–∞–∑–æ–≤–∞–Ω']
        },
        'speech_communication': {
            'name': '–†–µ—á—å –∏ –æ–±—â–µ–Ω–∏–µ',
            'description': '–§—Ä–∞–∑–µ–æ–ª–æ–≥–∏–∑–º—ã –æ —Ä–µ—á–∏, –æ–±—â–µ–Ω–∏–∏ –∏ —è–∑—ã–∫–µ',
            'keywords': ['–≥–æ–≤–æ—Ä–∏—Ç—å', '—Å–∫–∞–∑–∞—Ç—å', '—Å–ª–æ–≤–æ', '—Ä–µ—á—å', '—è–∑—ã–∫', '–º–æ–ª—á–∞—Ç—å', '–∫—Ä–∏—á–∞—Ç—å', '—à–µ–ø—Ç–∞—Ç—å', '–±–æ–ª—Ç–∞—Ç—å', '—Ä–∞—Å—Å–∫–∞–∑', '–±–µ—Å–µ–¥–∞', '—Ä–∞–∑–≥–æ–≤–æ—Ä', '—Å–ø–æ—Ä', '—Å—Å–æ—Ä–∞', '—Ä—É–≥–∞—Ç—å', '—Ö–≤–∞–ª–∏—Ç—å', '–æ–±–µ—â–∞—Ç—å']
        },
        'food_drink': {
            'name': '–ï–¥–∞ –∏ –ø–∏—Ç—å–µ',
            'description': '–§—Ä–∞–∑–µ–æ–ª–æ–≥–∏–∑–º—ã –æ –ø–∏—â–µ –∏ –Ω–∞–ø–∏—Ç–∫–∞—Ö',
            'keywords': ['–µ—Å—Ç—å', '–ø–∏—Ç—å', '—Ö–ª–µ–±', '–º—è—Å–æ', '–º–æ–ª–æ–∫–æ', '–≤–æ–¥–∞', '–≤–∏–Ω–æ', '–ø–∏–≤–æ', '—á–∞–π', '–∫–æ—Ñ–µ', '—Å–∞—Ö–∞—Ä', '—Å–æ–ª—å', '–º–∞—Å–ª–æ', '–∫–∞—à–∞', '—Å—É–ø', '–±–ª—é–¥–æ', '–∫—É—Ö–Ω—è', '—Å—Ç–æ–ª', '–æ–±–µ–¥', '—É–∂–∏–Ω', '–∑–∞–≤—Ç—Ä–∞–∫', '–≥–æ–ª–æ–¥', '—Å—ã—Ç']
        },
        'house_home': {
            'name': '–î–æ–º –∏ –±—ã—Ç',
            'description': '–§—Ä–∞–∑–µ–æ–ª–æ–≥–∏–∑–º—ã –æ –¥–æ–º–µ, –∂–∏–ª–∏—â–µ –∏ –ø–æ–≤—Å–µ–¥–Ω–µ–≤–Ω–æ–π –∂–∏–∑–Ω–∏',
            'keywords': ['–¥–æ–º', '–∏–∑–±–∞', '—Ö–∞—Ç–∞', '–∫–≤–∞—Ä—Ç–∏—Ä–∞', '–∫–æ–º–Ω–∞—Ç–∞', '–∫—É—Ö–Ω—è', '–¥–≤–æ—Ä', '—Å–∞–¥', '–æ–≥–æ—Ä–æ–¥', '–∫—Ä—ã—à–∞', '—Å—Ç–µ–Ω–∞', '–¥–≤–µ—Ä—å', '–æ–∫–Ω–æ', '—Å—Ç–æ–ª', '—Å—Ç—É–ª', '–∫—Ä–æ–≤–∞—Ç—å', '–ø–µ—á—å', '–æ—á–∞–≥', '–±—ã—Ç', '—Ö–æ–∑—è–π—Å—Ç–≤']
        },
        'war_conflict': {
            'name': '–í–æ–π–Ω–∞ –∏ –∫–æ–Ω—Ñ–ª–∏–∫—Ç—ã',
            'description': '–§—Ä–∞–∑–µ–æ–ª–æ–≥–∏–∑–º—ã –æ –≤–æ–µ–Ω–Ω—ã—Ö –¥–µ–π—Å—Ç–≤–∏—è—Ö –∏ –∫–æ–Ω—Ñ–ª–∏–∫—Ç–∞—Ö',
            'keywords': ['–≤–æ–π–Ω–∞', '–±–∏—Ç–≤–∞', '–±–æ–π', '—Å—Ä–∞–∂–µ–Ω–∏–µ', '–≤—Ä–∞–≥', '–¥—Ä—É–≥', '—Å–æ–ª–¥–∞—Ç', '–æ—Ñ–∏—Ü–µ—Ä', '–≥–µ–Ω–µ—Ä–∞–ª', '–∞—Ä–º–∏—è', '–ø–æ–ª–∫', '–æ—Ä—É–∂–∏–µ', '–º–µ—á', '–∫–æ–ø—å–µ', '–ø—É—à–∫–∞', '—Ä—É–∂—å–µ', '–ø–æ–±–µ–¥–∞', '–ø–æ—Ä–∞–∂–µ–Ω–∏–µ', '–º–∏—Ä', '–¥—Ä–∞–∫–∞', '—Å—Å–æ—Ä–∞']
        },
        'weather_nature': {
            'name': '–ü–æ–≥–æ–¥–∞ –∏ –ø—Ä–∏—Ä–æ–¥–∞',
            'description': '–§—Ä–∞–∑–µ–æ–ª–æ–≥–∏–∑–º—ã –æ –ø–æ–≥–æ–¥–Ω—ã—Ö —è–≤–ª–µ–Ω–∏—è—Ö –∏ –ø—Ä–∏—Ä–æ–¥–µ',
            'keywords': ['–¥–æ–∂–¥—å', '—Å–Ω–µ–≥', '–≤–µ—Ç–µ—Ä', '–±—É—Ä—è', '–≥—Ä–æ–∑–∞', '—Ç—É–º–∞–Ω', '—Å–æ–ª–Ω—Ü–µ', '–ª—É–Ω–∞', '–∑–≤–µ–∑–¥', '–Ω–µ–±–æ', '–∑–µ–º–ª—è', '–º–æ—Ä–µ', '—Ä–µ–∫–∞', '–ª–µ—Å', '–ø–æ–ª–µ', '–≥–æ—Ä–∞', '—Ö–æ–ª–æ–¥', '—Ç–µ–ø–ª–æ', '–∂–∞—Ä–∞', '–º–æ—Ä–æ–∑', '–ª–µ—Ç–æ', '–∑–∏–º–∞', '–≤–µ—Å–Ω–∞', '–æ—Å–µ–Ω—å']
        },
        'transport_travel': {
            'name': '–¢—Ä–∞–Ω—Å–ø–æ—Ä—Ç –∏ –ø—É—Ç–µ—à–µ—Å—Ç–≤–∏—è',
            'description': '–§—Ä–∞–∑–µ–æ–ª–æ–≥–∏–∑–º—ã –æ –ø–µ—Ä–µ–¥–≤–∏–∂–µ–Ω–∏–∏ –∏ –ø—É—Ç–µ—à–µ—Å—Ç–≤–∏—è—Ö',
            'keywords': ['–¥–æ—Ä–æ–≥–∞', '–ø—É—Ç—å', '–µ—Ö–∞—Ç—å', '–∏–¥—Ç–∏', '–±–µ–∂–∞—Ç—å', '–ª–µ—Ç–µ—Ç—å', '–ø–ª—ã—Ç—å', '–∫–æ—Ä–∞–±–ª—å', '–ª–æ–¥–∫–∞', '—Ç–µ–ª–µ–≥–∞', '—Å–∞–Ω–∏', '–ª–æ—à–∞–¥—å', '–≤–æ–∑', '–ø—É—Ç–µ—à–µ—Å—Ç–≤', '–ø–æ–µ–∑–¥–∫–∞', '–ø—Ä–æ–≥—É–ª–∫–∞']
        },
        'character_behavior': {
            'name': '–•–∞—Ä–∞–∫—Ç–µ—Ä –∏ –ø–æ–≤–µ–¥–µ–Ω–∏–µ',
            'description': '–§—Ä–∞–∑–µ–æ–ª–æ–≥–∏–∑–º—ã –æ —á–µ–ª–æ–≤–µ—á–µ—Å–∫–æ–º —Ö–∞—Ä–∞–∫—Ç–µ—Ä–µ –∏ –ø–æ–≤–µ–¥–µ–Ω–∏–∏',
            'keywords': ['—Ö–∞—Ä–∞–∫—Ç–µ—Ä', '–Ω—Ä–∞–≤', '–ø–æ–≤–µ–¥–µ–Ω–∏–µ', '–¥–æ–±—Ä—ã–π', '–∑–ª–æ–π', '—Ö–æ—Ä–æ—à–∏–π', '–ø–ª–æ—Ö–æ–π', '—á–µ—Å—Ç–Ω—ã–π', '–ª–∂–∏–≤—ã–π', '—Ö—Ä–∞–±—Ä—ã–π', '—Ç—Ä—É—Å–ª–∏–≤—ã–π', '–≥–æ—Ä–¥—ã–π', '—Å–∫—Ä–æ–º–Ω—ã–π', '–∂–∞–¥–Ω—ã–π', '—â–µ–¥—Ä—ã–π', '–ª–µ–Ω–∏–≤—ã–π', '—Ç—Ä—É–¥–æ–ª—é–±–∏–≤']
        },
        'health_disease': {
            'name': '–ó–¥–æ—Ä–æ–≤—å–µ –∏ –±–æ–ª–µ–∑–Ω–∏',
            'description': '–§—Ä–∞–∑–µ–æ–ª–æ–≥–∏–∑–º—ã –æ –∑–¥–æ—Ä–æ–≤—å–µ –∏ –Ω–µ–¥—É–≥–∞—Ö',
            'keywords': ['–∑–¥–æ—Ä–æ–≤—å–µ', '–±–æ–ª–µ–∑–Ω—å', '–±–æ–ª—å–Ω–æ–π', '–∑–¥–æ—Ä–æ–≤—ã–π', '–ª–µ—á–∏—Ç—å', '–≤—Ä–∞—á', '–ª–µ–∫–∞—Ä—Å—Ç–≤–æ', '–±–æ–ª—å', '—Ä–∞–Ω–∞', '—è–∑–≤–∞', '–ª–∏—Ö–æ—Ä–∞–¥–∫–∞', '–∫–∞—à–µ–ª—å', '—á—É–º–∞', '—Å–º–µ—Ä—Ç—å', '—É–º–µ—Ä–µ—Ç—å']
        },
        'quantity_measure': {
            'name': '–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –∏ –º–µ—Ä–∞',
            'description': '–§—Ä–∞–∑–µ–æ–ª–æ–≥–∏–∑–º—ã –æ –∫–æ–ª–∏—á–µ—Å—Ç–≤–µ, —Ä–∞–∑–º–µ—Ä–µ –∏ –º–µ—Ä–µ',
            'keywords': ['–º–Ω–æ–≥–æ', '–º–∞–ª–æ', '–±–æ–ª—å—à', '–º–∞–ª–µ–Ω—å–∫', '–æ–≥—Ä–æ–º–Ω', '–∫—Ä–æ—à–µ—á–Ω', '–¥–ª–∏–Ω–Ω', '–∫–æ—Ä–æ—Ç–∫', '—à–∏—Ä–æ–∫', '—É–∑–∫', '–≤—ã—Å–æ–∫', '–Ω–∏–∑–∫', '–≥–ª—É–±–æ–∫', '–º–µ–ª–∫', '—Ç–æ–ª—Å—Ç', '—Ç–æ–Ω–∫', '—Ä–∞–∑–º–µ—Ä', '–º–µ—Ä–∞']
        },
        'colors_light': {
            'name': '–¶–≤–µ—Ç–∞ –∏ —Å–≤–µ—Ç',
            'description': '–§—Ä–∞–∑–µ–æ–ª–æ–≥–∏–∑–º—ã —Å —Ü–≤–µ—Ç–∞–º–∏ –∏ —Å–≤–µ—Ç–æ–≤—ã–º–∏ —è–≤–ª–µ–Ω–∏—è–º–∏',
            'keywords': ['–±–µ–ª—ã–π', '—á–µ—Ä–Ω—ã–π', '–∫—Ä–∞—Å–Ω—ã–π', '—Å–∏–Ω–∏–π', '–∑–µ–ª–µ–Ω—ã–π', '–∂–µ–ª—Ç—ã–π', '—Å–µ—Ä—ã–π', '—Ä–æ–∑–æ–≤—ã–π', '—Ñ–∏–æ–ª–µ—Ç–æ–≤', '—Å–≤–µ—Ç', '—Ç—å–º–∞', '—Ç–µ–º–Ω–æ—Ç–∞', '—è—Ä–∫–∏–π', '—Ç—É—Å–∫–ª—ã–π', '–±–ª–µ—Å–∫', '—Å–∏—è—Ç—å']
        },
        'luck_fortune': {
            'name': '–£–¥–∞—á–∞ –∏ —Å—É–¥—å–±–∞',
            'description': '–§—Ä–∞–∑–µ–æ–ª–æ–≥–∏–∑–º—ã –æ –≤–µ–∑–µ–Ω–∏–∏, –Ω–µ–≤–µ–∑–µ–Ω–∏–∏ –∏ —Å—É–¥—å–±–µ',
            'keywords': ['—É–¥–∞—á–∞', '–≤–µ–∑–µ–Ω–∏–µ', '—Å—É–¥—å–±–∞', '—Ä–æ–∫', '—Å—á–∞—Å—Ç—å–µ', '–Ω–µ—Å—á–∞—Å—Ç—å–µ', '—É—á–∞—Å—Ç—å', '–¥–æ–ª—è', '–∂—Ä–µ–±–∏–π', '—Å–ª—É—á–∞–π', '–≤–µ–∑—Ç–∏', '—Ñ–æ—Ä—Ç—É–Ω–∞', '–∑–≤–µ–∑–¥–∞']
        }
    }
    
    # Add category information to each phrase
    categorized_count = 0
    category_stats = defaultdict(int)
    
    for phrase_data in phrases:
        phrase = phrase_data['phrase'].lower()
        meanings = ' '.join(phrase_data.get('meanings', [])).lower()
        etymology = phrase_data.get('etymology', '').lower()
        
        full_text = f"{phrase} {meanings} {etymology}"
        
        # Find matching category
        assigned_category = 'general'  # Default category
        
        for category_key, category_info in categories.items():
            for keyword in category_info['keywords']:
                if keyword in full_text:
                    assigned_category = category_key
                    break
            if assigned_category != 'general':
                break
        
        # Add category to phrase data
        phrase_data['category'] = assigned_category
        category_stats[assigned_category] += 1
        
        if assigned_category != 'general':
            categorized_count += 1
    
    # Add category metadata to the structure
    result_data = {
        'categories': {**categories, 'general': {
            'name': '–û–±—â–∏–µ –≤—ã—Ä–∞–∂–µ–Ω–∏—è',
            'description': '–†–∞–∑–ª–∏—á–Ω—ã–µ —Ñ—Ä–∞–∑–µ–æ–ª–æ–≥–∏–∑–º—ã –æ–±—â–µ–≥–æ —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∞',
            'keywords': []
        }},
        'phrases': phrases,
        'stats': {
            'total_phrases': len(phrases),
            'categorized_phrases': categorized_count,
            'general_phrases': len(phrases) - categorized_count,
            'total_categories': len(categories) + 1
        }
    }
    
    # Create backup of original file
    backup_filename = 'table_phrases_backup.json'
    with open(backup_filename, 'w', encoding='utf-8') as f:
        json.dump(phrases, f, ensure_ascii=False, indent=2)
    print(f"Created backup: {backup_filename}")
    
    # Save updated file
    with open('table_phrases.json', 'w', encoding='utf-8') as f:
        json.dump(result_data, f, ensure_ascii=False, indent=2)
    
    print(f"\n‚úÖ Successfully updated table_phrases.json!")
    print(f"üìä Statistics:")
    print(f"  - Total phrases: {len(phrases)}")
    print(f"  - Categorized: {categorized_count}")
    print(f"  - General: {len(phrases) - categorized_count}")
    print(f"  - Categories: {len(categories) + 1}")
    
    print(f"\nüìà Category distribution:")
    for category, count in sorted(category_stats.items(), key=lambda x: x[1], reverse=True):
        category_name = categories.get(category, {}).get('name', category)
        if category == 'general':
            category_name = '–û–±—â–∏–µ –≤—ã—Ä–∞–∂–µ–Ω–∏—è'
        print(f"  - {category_name}: {count} phrases")
    
    return True

if __name__ == "__main__":
    print("üîÑ Adding category information to table_phrases.json...")
    success = add_categories_to_table_phrases()
    
    if success:
        print("\nüéâ Task completed successfully!")
        print("üìù Note: Original file backed up as table_phrases_backup.json")
        print("üí° The updated table_phrases.json now includes category information for each phrase.")
    else:
        print("\n‚ùå Task failed!")